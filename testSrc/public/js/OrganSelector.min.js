/*
组织结构选择器，依赖easyui框架实现
*/
//选择组织项：
//type：展示节点类型：0展示所有节点，1仅部门岗位节点，2部门岗位与人员节点（无角色），3仅角色节点，4仅部门（无岗位），5仅人员（无部门和岗位）
//retType：返回节点类型：0返回所有勾选上的节点，1仅返回勾选节点的最上级节点，2仅返回勾选节点中的人员节点(如果勾选了角色，这些角色节点也返回，需要调用者处理)
//  对于返回类型1，举例说明：
// []D0
//   [√]D1
//      [√]D11
//        [√]P1
//        []U1
//      []D12
//   [√]D2
//     [√]P2
//       []U2
//   []D3
// 这里D1，D11，P1，D2，P2有勾选，而P1的上级D11有勾选，同时D11的上级D1也有勾选；P2的上级D2有勾选，所以只返回D1，D2节点
//bMultiple：是否多选（在retType==2时，如果是单选，若选中非人员节点，提示不正确实；
//    如果是多选，若选中非叶子节点，返回此节点下的所有人员节点）
//initSel：需要初始选中的组织项ID数组
//resultFun：选择结果回调方法，原型：function (selNodes,treeCtrl,userData)
//    selNodes为所有选中组织项对象数组；每个元素包含属性：
//id,组织项ID；text,组织项名；attributes,扩展属性
//{mdistrict:所属行政区划,organCode:内部代码,organDescription:描述,organType:组织项类型(0部门1岗位2自定义角色3系统角色10人员),status:组织项状态(-1审核中0不可用1可用)}
//    treeCtrl为节点所在树控件；
//    userData需要传递的用户参数。
//userData：需要传递的参数，这个参数将会通过回调方法返回
//innerContId：组织结构树所在容器的id属性值（如果不为空，放置在调用者指定的容器中；如果为空，则弹出对话框）。
//Owidth: 容器宽度
//Oheigh:容器高度
var cacheType4aGwn="",_organParam;function selectOrganization(e,f,c,b,d,k,a,g,l){var m=this;_organParam={retType:f,bMultiple:c,userData:k};var h="";null!=g&&void 0!=g||(g=330);null!=l&&void 0!=l||(l=450);h=(a?h+('\x3cdiv id\x3d"organWin4aGwn" style\x3d"width:'+g+"px;height:"+l+'px"\x3e'):h+('\x3cdiv id\x3d"organCont4aGwn"\x3e\x3cdiv id\x3d"organWin4aGwn" class\x3d"easyui-dialog" style\x3d"width:'+g+"px;height:"+l+'px;" title\x3d"\u7ec4\u7ec7\u7ed3\u6784\u4fe1\u606f" data-options\x3d"buttons:\'#organWin-btns4aGwn\',closed:false,modal:true"\x3e'))+'\x3cdiv class\x3d"easyui-layout" data-options\x3d"border:false,fit:true," style\x3d"width:100%;height:100%;"\x3e\x3cdiv style\x3d""\x3e\x3cinput id\x3d"findCTree7811q" class\x3d"easyui-searchbox" prompt\x3d"\u67e5\u627e\u6570\u636e" style\x3d"width:100%;height:30px;" data-options\x3d"searcher:searchOrganTT4aGwnNode"/\x3e\x3c/div\x3e\x3cdiv style\x3d"top:30px;bottom:0;width:100%;overflow:auto;position:absolute;"\x3e\x3cul id\x3d"organTT4aGwn" style\x3d"overflow:hidden;"\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e';h=a?h+"\x3c/div\x3e":h+'\x3cdiv id\x3d"organWin-btns4aGwn" style\x3d"text-align:center;line-height:30px;height:30px;"\x3e\x3ca class\x3d"easyui-linkbutton" data-options\x3d"iconCls:\'icon-ok\'" onclick\x3d"submitOrganTT()"\x3e\u786e\u5b9a\x3c/a\x3e\x26nbsp;\x3ca class\x3d"easyui-linkbutton" data-options\x3d"iconCls:\'icon-cancel\'" onclick\x3d"cancelOrganTT()" \x3e\u53d6\u6d88\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e';g=e+""+c+""+a;if(cacheType4aGwn!=g||0==$("#organWin4aGwn").length){cacheType4aGwn=g;0<$("#organCont4aGwn").length?($("#organWin4aGwn").window("destroy"),$("#organCont4aGwn").remove()):0<$("#organWin4aGwn").length&&$("#organWin4aGwn").remove();a?($("#"+a).html(h),$.parser.parse("#"+a)):($("body").append(h),$.parser.parse("#organCont4aGwn"));var n=2==f;$.ajax({url:"/mainWeb/system/getOrganTree?valid\x3d1\x26type\x3d"+e,type:"POST",dataType:"json",success:function(a){$("#organTT4aGwn").tree({method:"get",animate:!1,checkbox:c,onDblClick:function(a){c?a.checked?$("#organTT4aGwn").tree("uncheck",a.target):$("#organTT4aGwn").tree("check",a.target):m.submitOrganTT()},cascadeCheck:n,onCheck:organCheckRoot4aGwn,data:a});c&&$("#btnClear4aGwn").css("display","");initSelNode4aGwn(b,c)},error:function(a){$.messager.alert("\u63d0\u793a","\u7ec4\u7ec7\u7ed3\u6784\u6570\u636e\u83b7\u53d6\u5931\u8d25")}})}else a||$("#organWin4aGwn").window("open"),initSelNode4aGwn(b,c);this.submitOrganTT=function(){var b=GetSelectedOrgans(!0);if(b){var c=$("#organTT4aGwn");a||$("#organWin4aGwn").dialog("close");d&&d(b,c,k)}};this.cancelOrganTT=function(){$("#organWin4aGwn").dialog("close")};this.clearSelectTT=function(){for(var a=$("#organTT4aGwn"),b=a.tree("getChecked"),c=0;c<b.length;++c)a.tree("uncheck",b[c].target)}}function GetSelectedOrgans(e,f){var c=$("#organTT4aGwn"),b=[];if(_organParam.bMultiple)for(var d=c.tree("getChecked"),k=[],a=0;a<d.length;++a)IsValidId(d[a].id)&&0>k.indexOf(d[a].id)&&(k.push(d[a].id),b.push(d[a]));else a=c.tree("getSelected"),null!=a&&IsValidId(a.id)&&b.push(a);if(0==b.length)return f||$.messager.alert("\u63d0\u793a","\u8bf7\u9009\u62e9\u9700\u8981\u7684\u7ec4\u7ec7\u9879!"),null;d=[];if(0==_organParam.retType)d=b;else if(1==_organParam.retType)for(a=0;a<b.length;++a)IsParentCheck(c,b[a])||d.push(b[a]);else if(2==_organParam.retType)for(a=0;a<b.length;++a)10==b[a].attributes.organType?d.push(b[a]):2!=b[a].attributes.organType&&3!=b[a].attributes.organType||d.push(b[a]);return 0==d.length?(f||$.messager.alert("\u63d0\u793a","\u8bf7\u9009\u62e9\u6b63\u786e\u7684\u7ec4\u7ec7\u9879!"),null):e?d:{nodes:d,treeCtrl:c,userData:_organParam.userData}}function initSelNode4aGwn(e,f){if(f){var c=$("#organTT4aGwn").tree("getChecked");if(0<c.length)for(var b=0;b<c.length;++b)$("#organTT4aGwn").tree("uncheck",c[b].target)}else c=$("#organTT4aGwn").tree("getSelected"),null!=c&&$(c.target).removeClass("tree-node-selected");if(e&&0!=e.length)for(b=0;b<e.length;b++)if(c=$("#organTT4aGwn").tree("find",e[b]),null!=c)if(f)$("#organTT4aGwn").tree("check",c.target);else{selectNode($("#organTT4aGwn"),c);break}}function organCheckRoot4aGwn(e,f){if(e&&!IsValidId(e.id))for(var c=$("#organTT4aGwn"),b=GetDirectChildren(c,e),d=0;d<b.length;++d)c.tree(f?"check":"uncheck",b[d].target)}function searchOrganTT4aGwnNode(e){console.log(e);searchTreeNode($("#organTT4aGwn"),e)};
//# sourceMappingURL=OrganSelector.min.js.map
