$.extend($.fn.datagrid.defaults,{rowHeight:25,onBeforeFetch:function(b){},onFetch:function(b,f){}});var bufferview=$.extend({},$.fn.datagrid.defaults.view,{render:function(b,f,d){var a=$.data(b,"datagrid"),e=a.options,c=this.rows||[];if(c.length){var p=$(b).datagrid("getColumnFields",d);if(!d||e.rownumbers||e.frozenColumns&&e.frozenColumns.length){for(var g=parseInt(e.finder.getTr(b,"","last",d?1:2).attr("datagrid-row-index"))+1||0,h=['\x3ctable class\x3d"datagrid-btable" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0"\x3e\x3ctbody\x3e'],l=0;l<c.length;l++){var k=e.rowStyler?e.rowStyler.call(b,g,c[l]):"",n="",m="";"string"==typeof k?m=k:k&&(n=k["class"]||"",m=k.style||"");h.push('\x3ctr id\x3d"'+(a.rowIdPrefix+"-"+(d?1:2)+"-"+g)+'" datagrid-row-index\x3d"'+g+'" '+('class\x3d"datagrid-row '+(g%2&&e.striped?"datagrid-row-alt ":" ")+n+'"')+" "+(m?'style\x3d"'+m+'"':"")+"\x3e");h.push(this.renderRow.call(this,b,p,d,g,c[l]));h.push("\x3c/tr\x3e");g++}h.push("\x3c/tbody\x3e\x3c/table\x3e");$(f).append(h.join(""))}}},onBeforeRender:function(b){function f(){c.renderedCount*a.rowHeight<e.body2.height()&&c.renderedCount<d.data.total?this.getRows.call(this,b,function(a){this.rows=a;this.populate.call(this,b);e.body2.triggerHandler("scroll.datagrid")}):e.body2.scrollTop()>=c.renderedCount*a.rowHeight-e.body2.height()&&this.getRows.call(this,b,function(a){this.rows=a;this.populate.call(this,b)})}var d=$.data(b,"datagrid"),a=d.options,e=d.dc,c=this;this.renderedCount=0;this.rows=[];e.body1.add(e.body2).empty();(function(){d.onLoadSuccess=a.onLoadSuccess;a.onLoadSuccess=function(){};setTimeout(function(){e.body2.unbind(".datagrid").bind("scroll.datagrid",function(b){d.onLoadSuccess&&(a.onLoadSuccess=d.onLoadSuccess,d.onLoadSuccess=void 0);c.scrollTimer&&clearTimeout(c.scrollTimer);c.scrollTimer=setTimeout(function(){f.call(c)},50)});e.body2.triggerHandler("scroll.datagrid")},0)})()},getRows:function(b,f){var d=$.data(b,"datagrid"),a=d.options,e=Math.floor(this.renderedCount/a.pageSize)+1;if(!(this.renderedCount>=d.data.total)&&0!=a.onBeforeFetch.call(b,e)){var c=(e-1)*a.pageSize,c=d.data.rows.slice(c,c+a.pageSize);c.length?(a.onFetch.call(b,e,c),f.call(this,c)):(c=$.extend({},a.queryParams,{page:Math.floor(this.renderedCount/a.pageSize)+1,rows:a.pageSize}),a.sortName&&$.extend(c,{sort:a.sortName,order:a.sortOrder}),0!=a.onBeforeLoad.call(b,c)&&($(b).datagrid("loading"),0==a.loader.call(b,c,function(c){$(b).datagrid("loaded");c=a.loadFilter.call(b,c);a.onFetch.call(b,e,c.rows);c.rows&&c.rows.length?(d.data.rows=d.data.rows.concat(c.rows),f.call(a.view,c.rows)):a.onLoadSuccess.call(b,c)},function(){$(b).datagrid("loaded");a.onLoadError.apply(b,arguments)})&&($(b).datagrid("loaded"),d.data.rows.length||(a.onFetch.call(b,e,d.data.rows),a.onLoadSuccess.call(b,d.data)))))}},populate:function(b){var f=$.data(b,"datagrid"),d=f.options,a=f.dc;this.rows.length&&(this.renderedCount+=this.rows.length,this.render.call(this,b,a.body2,!1),this.render.call(this,b,a.body1,!0),d.onLoadSuccess.call(b,{total:f.data.total,rows:this.rows}))}});
//# sourceMappingURL=datagrid-bufferview.min.js.map
